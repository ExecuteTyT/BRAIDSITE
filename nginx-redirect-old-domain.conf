# 301 редирект со старого домена braidvpn.ru → braidx.tech
# Этот конфиг ставится на сервер, где ещё висит старый домен
#
# Назначение:
# - Перенаправляет весь трафик с braidvpn.ru на braidx.tech
# - Сохраняет URI-путь (например /pricing → /pricing)
# - 301 (постоянный) для передачи SEO-веса на новый домен
# - Работает для Google/Yandex ботов, которые ещё могут обращаться к старому домену
#
# Установка:
#   sudo cp nginx-redirect-old-domain.conf /etc/nginx/sites-available/braidvpn.ru
#   sudo ln -sf /etc/nginx/sites-available/braidvpn.ru /etc/nginx/sites-enabled/braidvpn.ru
#   sudo nginx -t && sudo systemctl reload nginx

# HTTP → новый домен
server {
    listen 80;
    listen [::]:80;
    server_name braidvpn.ru www.braidvpn.ru;

    return 301 https://braidx.tech$request_uri;
}

# HTTPS www → новый домен
server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name www.braidvpn.ru;

    ssl_certificate /etc/letsencrypt/live/braidvpn.ru/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/braidvpn.ru/privkey.pem;

    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;

    return 301 https://braidx.tech$request_uri;
}

# HTTPS без www → новый домен
server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name braidvpn.ru;

    ssl_certificate /etc/letsencrypt/live/braidvpn.ru/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/braidvpn.ru/privkey.pem;

    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;

    return 301 https://braidx.tech$request_uri;
}
